!function(){"use strict"
  function r(r,e,o,t,a,s,l,n,i){function u(){K.search="",document.getElementById("filter").focus()}function d(r){var e={bookmark:r},t=!1
    a.isSupported&&(e.username=a.get("username"),t=!0),a.cookie.isSupported&&(e.username=a.cookie.get("username"),t=!0),t||(humane.log("Server error, log in again"),o.go("login")),s.sendPost(e,ROUTE.STAR_BOOKMARK,ROUTE.STAR_BOOKMARK_SUCCESS,ROUTE.STAR_BOOKMARK_FAIL)}function k(r){for(var e=0;e<K.user.folders.length;e++){var o=K.user.folders[e]
    r.name===o.name?(o.isActive=!0,K.user.activeFolder=o):o.isActive=!1}}function m(){K.showOverlay=!0}function g(){if(K.showOverlay&&(K.showOverlay=!1),K.editBookmarkMode){for(var r=M(K.bookmarkEdit,K.bookmarkEditOriginal),e=0;e<r.length;e++){var o=r[e]
    K.bookmarkEdit[o]=K.bookmarkEditOriginal[o]}K.editBookmarkMode=!1}}function f(r){if(!r||0===r.trim("").length)return void humane.log("You need some content for your name",{addCls:"humane-flatty-error"})
    K.folder.name=""
    var e={}
    a.isSupported?e.username=a.get("username"):e.username=a.cookie.get("username"),e.name=r,e.bookmarks=[],e.username||(humane.log("Something went wrong, log in again",{addCls:"humane-flatty-error"}),o.go("login")),s.sendPost(e,ROUTE.ADD_FOLDER,ROUTE.ADD_FOLDER_SUCCESS,ROUTE.ADD_FOLDER_FAIL)}function S(){if("all"===K.user.activeFolder.name)return void humane.log("You can't delete all",{addCls:"humane-flatty-error"})
    var r={name:K.user.activeFolder.name}
    a.isSupported?r.username=a.get("username"):r.username=a.cookie.get("username"),s.sendPost(r,ROUTE.DELETE_FOLDER,ROUTE.DELETE_FOLDER_SUCCESS,ROUTE.DELETE_FOLDER_FAIL)}function h(r){var e={bookmark:r}
    a.isSupported?e.username=a.get("username"):e.username=a.cookie.get("username"),s.sendPost(e,ROUTE.DELETE_BOOKMARK,ROUTE.DELETE_BOOKMARK_SUCCESS,ROUTE.DELETE_BOOKMARK_FAIL)}function c(r){var e={bookmark:r}
    s.sendPost(e,ROUTE.USED_BOOKMARK,ROUTE.USED_BOOKMARK_SUCCESS,ROUTE.USED_BOOKMARK_FAIL)
    var o=r.url
    window.location.href=o}function E(){if("all"===K.user.activeFolder.name)return void humane.log("You cannot export all",{addCls:"humane-flatty-error"})
    var r={name:K.user.activeFolder.name}
    s.sendPost(r,ROUTE.EXPORT_FOLDER,ROUTE.EXPORT_FOLDER_SUCCESS,ROUTE.EXPORT_BOOKMARK_FAIL)}function O(r){var e={title:r.title}
    s.sendPost(e,ROUTE.EXPORT_BOOKMARK,ROUTE.EXPORT_BOOKMARK_SUCCESS,ROUTE.EXPORT_FOLDER_FAIL)}function v(r){return K.modeMobile?void humane.log("This feature is currently unavailable on mobile"):(K.showOverlay=!0,K.editBookmarkMode=!0,r.description&&0!==r.description.trim().length||(r.description=""),R(r.tag1)||(r.tag1=""),R(r.tag2)||(r.tag2=""),R(r.tag3)||(r.tag3=""),R(r.tag4)||(r.tag4=""),K.bookmarkEditOriginal=JSON.parse(JSON.stringify(r)),K.bookmarkEdit=r,void(K.bookmarkEdit.oldTitle=r.title))}function M(r,e){var o=[]
    return r.title!=e.title&&o.push("title"),r.url!=e.url&&o.push("url"),r.description!=e.description&&o.push("description"),r.tag1!=e.tag1&&o.push("tag1"),r.tag2!=e.tag2&&o.push("tag2"),r.tag3!=e.tag3&&o.push("tag3"),r.tag4!=e.tag4&&o.push("tag4"),r.folder!=e.folder&&o.push("folder"),o}function T(){var r=K.bookmarkEdit,e={bookmark:r}
    K.editBookmarkMode=!1,s.sendPost(e,ROUTE.UPDATE_BOOKMARK,ROUTE.UPDATE_BOOKMARK_SUCCESS,ROUTE.UPDATE_BOOKMARK_FAIL)}function R(r){return!(!r||0===r.trim("").length||"null"===r||"NULL"===r||null===r)}function b(){K.user.lastTitleSort?(F("titleSortMethod"),K.sort.titleSortMethod="sort-down",K.user.lastSortMethod="sortTitleDown",K.user.lastTitleSort=!1,K.user.activeFolder.bookmarks=l.aToZTitle(K.user.activeFolder.bookmarks)):(F("titleSortMethod"),K.sort.titleSortMethod="sort-up",K.user.lastSortMethod="sortTitleUp",K.user.lastTitleSort=!0,K.user.activeFolder.bookmarks=l.zToATitle(K.user.activeFolder.bookmarks))}function p(){K.user.lastUrlSort?(F("urlSortMethod"),K.sort.urlSortMethod="sort-down",K.user.lastSortMethod="sortUrlDown",K.user.lastUrlSort=!1,K.user.activeFolder.bookmarks=l.aToZUrl(K.user.activeFolder.bookmarks)):(F("urlSortMethod"),K.sort.urlSortMethod="sort-up",K.user.lastSortMethod="sortUrlUp",K.user.lastUrlSort=!0,K.user.activeFolder.bookmarks=l.zToAUrl(K.user.activeFolder.bookmarks))}function U(){K.user.lastSortLastVisit?(F("visitSortMethod"),K.sort.visitSortMethod="sort-down",K.user.lastSortMethod="sortLastVisitDown",K.user.lastSortLastVisit=!1,K.user.activeFolder.bookmarks=l.zeroToNineSortLastVisit(K.user.activeFolder.bookmarks)):(F("visitSortMethod"),K.sort.visitSortMethod="sort-up",K.user.lastSortMethod="sortLastVisitUp",K.user.lastSortLastVisit=!0,K.user.activeFolder.bookmarks=l.nineToZeroSortLastVisit(K.user.activeFolder.bookmarks))}function _(){K.user.lastSortCreationDate?(F("creationSortMethod"),K.sort.creationSortMethod="sort-down",K.user.lastSortMethod="sortCreationDateDown",K.user.lastSortCreationDate=!1,K.user.activeFolder.bookmarks=l.zeroToNineSortCreationDate(K.user.activeFolder.bookmarks)):(F("creationSortMethod"),K.sort.creationSortMethod="sort-up",K.user.lastSortMethod="sortCreationDateUp",K.user.lastSortCreationDate=!0,K.user.activeFolder.bookmarks=l.nineToZeroSortCreationDate(K.user.activeFolder.bookmarks))}function C(){K.user.lastSortCounter?(F("counterSortMethod"),K.sort.counterSortMethod="sort-down",K.user.lastSortMethod="sortCounterDown",K.user.lastSortCounter=!1,K.user.activeFolder.bookmarks=l.zeroToNineSortCounter(K.user.activeFolder.bookmarks)):(F("counterSortMethod"),K.sort.counterSortMethod="sort-up",K.user.lastSortMethod="sortCounterUp",K.user.lastSortCounter=!0,K.user.activeFolder.bookmarks=l.nineToZeroSortCounter(K.user.activeFolder.bookmarks))}function F(r){for(var e in K.sort)e!=r&&K.sort.hasOwnProperty(e)&&(K.sort[e]="sort")}function D(){K.showRealFolderInput=!0}function A(){K.showRealBookmarkInput=!0}var K=this
    K.clearSearch=u,K.clickStar=d,K.selectFolder=k,K.beginCreateFolder=m,K.clickOverlay=g,K.addFolder=f,K.deleteFolder=S,K.deleteBookmark=h,K.goToBookmark=c,K.exportFolder=E,K.exportBookmark=O,K.editBookmark=v,K.saveChanges=T,K.sortTitle=b,K.sortUrl=p,K.sortLastVisit=U,K.sortCreationDate=_,K.sortCounter=C,K.onInputChosen=D,K.onInputBookmarkChosen=A,K.warnCookies=!a.cookie.isSupported,a.set("cse136team10"),K.user={},K.user.name=a.cookie.get("username"),K.user.noFolderBookmarks=[],K.user.activeFolder=null,K.user.folders=[],K.user.folderHM={},K.folder={},K.folder.name="",K.session={},K.session.bookmarkHM={},K.bookmarkEdit={},K.bookmarkEditOriginal={},K.showRealFolderInput=!1,K.showRealBookmarkInput=!1,K.user.lastTitleSort=!1,K.user.lastUrlSort=!1,K.user.lastSortLastVisit=!1,K.user.lastSortCreationDate=!1,K.user.lastSortCounter=!1,K.modeMobile=!1,window.onresize=function(){console.log("window.innerWidth: "+window.innerWidth),window.innerWidth<=990?K.modeMobile=!0:K.modeMobile=!1},window.innerWidth<=990?K.modeMobile=!0:K.modeMobile=!1,K.sort={titleSortMethod:"sort",urlSortMethod:"sort",visitSortMethod:"sort",creationSortMethod:"sort",counterSortMethod:"sort"},K.user.lastSortMethod="",K.showOverlay=!1,K.editBookmarkMode=!1,r.addingBookmark=!1,r.$broadcast("show-nav")
    var B=null
    if(a.isSupported&&(B=a.get("username")),a.cookie.isSupported&&(B=a.cookie.get("username")),!B)return humane.log("You have been logged out, log back in",{addCls:"humane-flatty-error"}),void o.go("login")
    if(a.isSupported){var L=a.get("folderHM"),w=a.get("folders")
      L&&(K.user.folderHM=L),w&&(K.user.folders=w)}s.sendPost({username:K.user.name},ROUTE.GET_FOLDERS,ROUTE.GET_FOLDERS_SUCCESS,ROUTE.GET_FOLDERS_FAIL),e.$on(ROUTE.GET_FOLDERS_SUCCESS,function(r,e){if(!e||e.error||!e.rows)return humane.log("Server error try again later",{addCls:"humane-flatty-error"}),void o.go("login")
      var t=e.rows
      if(a.isSupported&&!n.getFolders()){var l={name:"all",isActive:!0,bookmarks:[]}
        K.user.activeFolder=l,K.user.folders.push(l),K.user.folderHM.all=l
        for(var i=0;i<t.length;i++){var u={}
          u.name=t[i].name,u.isActive=!1,u.bookmarks=[],K.user.folderHM[u.name]=u,K.user.folders.push(u)}}s.sendPost({username:K.user.name},ROUTE.GET_BOOKMARKS,ROUTE.GET_BOOKMARKS_SUCCESS,ROUTE.GET_BOOKMARKS_FAIL)}),e.$on(ROUTE.GET_FOLDERS_FAIL,function(){humane.log("Failed to retrieve folders, try to log in again",{addCls:"humane-flatty-error"}),o.go("login")}),e.$on(ROUTE.GET_BOOKMARKS_SUCCESS,function(e,t){if(t.error)return humane.log("Server error try again later",{addCls:"humane-flatty-error"}),void o.go("login")
      var a=t.rows
      K.user.bookmarkHM={}
      for(var s=0;s<a.length;s++){var l=a[s]
        K.user.bookmarkHM[l.title]=l,l.tags=[],"null"!=l.tag1&&0!=l.tag1.trim("").length&&l.tags.push(l.tag1),"null"!=l.tag2&&0!=l.tag2.trim("").length&&l.tags.push(l.tag2),"null"!=l.tag3&&0!=l.tag3.trim("").length&&l.tags.push(l.tag3),"null"!=l.tag4&&0!=l.tag4.trim("").length&&l.tags.push(l.tag4)
        var i=parseInt(l.star)+""
        l.star=i
        for(var u=l.title,d=0;d<l.tags.length;d++)u+=" "+l.tags[d]+" "
        if(l.searchstring=u,l.creationDate=l.creationDate.split("T")[0],l.lastVisit=l.lastVisit.split("T")[0],null===l.folder)K.noFolderBookmarks.push(l)
        else if(void 0===K.user.folderHM[l.folder]||null===K.user.folderHM[l.folder]);else{var k=K.user.folderHM[l.folder]
          k.bookmarks.push(l)}K.user.folderHM.all.bookmarks.push(l)}n.setFolders(K.user.folders),n.setFolderHM(K.user.folderHM),n.setBookmarkHM(K.user.bookmarkHM)
      var m={folders:K.user.folders}
      r.$broadcast("update-folders",m)}),e.$on(ROUTE.GET_BOOKMARKS_FAIL,function(r,e){humane.log("Failed to retrieve bookmarks, please log in again",{addCls:"humane-flatty-error"}),o.go("login")}),r.$on("add-bookmark",function(e,o){var t=o.bookmark
      "w"===t.url[0]&&"w"===t.url[1]&&"w"===t.url[2]&&(t.url="http://"+t.url)
      var a={bookmark:t,username:K.user.name}
      r.addingBookmark||s.sendPost(a,ROUTE.ADD_BOOKMARK,ROUTE.ADD_BOOKMARK_SUCCESS,ROUTE.ADD_BOOKMARK_FAIL),r.addingBookmark=!0}),e.$on(ROUTE.ADD_BOOKMARK_SUCCESS,function(e,t){if(r.addingBookmark=!1,t.error)return humane.log("Server error try again later",{addCls:"humane-flatty-error"}),void o.go("login")
      var a=t.bookmark
      if(!a)return void humane.log("This title has been already used, try another",{addCls:"humane-flatty-error"})
      a.tags=[],"null"!=a.tag1&&null!=a.tag1&&a.tags.push(a.tag1),"null"!=a.tag2&&null!=a.tag2&&a.tags.push(a.tag2),"null"!=a.tag3&&null!=a.tag3&&a.tags.push(a.tag3),"null"!=a.tag4&&null!=a.tag4&&a.tags.push(a.tag4)
      var s=parseInt(a.star)+""
      a.star=s
      for(var l=a.title,i=0;i<a.tags.length;i++)l+=" "+a.tags[i]+" "
      a.searchstring=l
      var u=new Date,d=""+(u.getYear()+1900)+"-"+(1===(""+(u.getMonth()+1)).length?"0"+(u.getMonth()+1):u.getMonth()+1)+"-"+(1===(""+u.getDate()).length?"0"+u.getDate():u.getDate())
      if(a.creationDate?a.creationDate=a.creationDate.split("T")[0]:a.creationDate=d,a.lastVisit?a.lastVisit=a.lastVisit.split("T")[0]:a.lastVisit=d,""!==a.folder.trim().length&&"null"!==a.folder&&a.folder)if(K.user.folderHM[a.folder]){var k=K.user.folderHM[a.folder]
        k.bookmarks.push(a)}else;else K.user.noFolderBookmarks.push(a)
      K.user.folderHM.all.bookmarks.push(a),n.addBookmark(a),r.$broadcast("added-bookmark",{})}),e.$on(ROUTE.ADD_FOLDER_SUCCESS,function(e,o){if(o.error)return void humane.log("Server error try again later",{addCls:"humane-flatty-error"})
      var t=o.folder
      K.user.folderHM[t.name]=t,K.user.folders.push(t),K.clickOverlay(),n.setFolders(K.user.folders),n.setFolderHM(K.user.folderHM)
      var a={folders:K.user.folders}
      r.$broadcast("update-folders",a)}),e.$on(ROUTE.DELETE_FOLDER_SUCCESS,function(e,t){if(t.error)return humane.log("Server error try again later",{addCls:"humane-flatty-error"}),void o.go("login")
      var a=t.folder
      K.user.folderHM[a.name]=null
      for(var s=0;s<K.user.folders.length;s++){var l=K.user.folders[s]
        if(l.name===a.name){K.user.folders.splice(s,1)
          break}}for(var i=K.user.folderHM.all,s=0;s<i.bookmarks.length;s++){var l=i.bookmarks[s]
        l.folder===a.name&&i.bookmarks.splice(s,1)}if(""!=a.name||"all"!=(""+a.name).toLowerCase())for(var s=0;s<a.bookmarks.length;s++){var l=a.bookmarks[s]
        n.deleteBookmark(l)}var u={folders:K.user.folders}
      r.$broadcast("update-folders",u),K.user.activeFolder=K.user.folderHM.all,K.user.activeFolder.isActive=!0}),e.$on(ROUTE.DELETE_FOLDER_FAIL,function(r,e){}),e.$on(ROUTE.DELETE_BOOKMARK_SUCCESS,function(r,e){if(e.error)return humane.log("Server error try again later",{addCls:"humane-flatty-error"}),void o.go("login")
      for(var t=e.bookmark,a=K.user.folderHM.all,s=0;s<a.bookmarks.length;s++){var l=a.bookmarks[s]
        if(l.title===t.title){a.bookmarks.splice(s,1)
          break}}var i=t.folder
      if(i&&"null"!==i&&"NULL"!==i&&null!==i&&""!==i){var u=K.user.folderHM[i]
        if(u)for(var s=0;s<u.bookmarks.length;s++){var l=u.bookmarks[s]
          if(l.title===t.title){u.bookmarks.splice(s,1)
            break}}}else;n.deleteBookmark(t)}),e.$on(ROUTE.DELETE_BOOKMARK_FAIL,function(r,e){}),e.$on(ROUTE.STAR_BOOKMARK_SUCCESS,function(r,e){if(e.error)return humane.log("Server error try again later",{addCls:"humane-flatty-error"}),void o.go("login")
      var t=e.bookmark,a=K.user.folderHM.all
      if(a)for(var s=0;s<a.bookmarks.length;s++)if(t.title===a.bookmarks[s].title){a.bookmarks[s].star="0"===t.star?"1":"0"
        break}n.updateBookmark(t)}),e.$on(ROUTE.STAR_BOOKMARK_FAIL,function(r,e){}),e.$on(ROUTE.USED_BOOKMARK_SUCCESS,function(r,e){var o=e.bookmark,t=o.folder
      if(t)for(var a=K.user.folderHM[t],s=0;s<a.bookmarks.length;s++){var l=a.bookmarks[s]
        if(o.title===l.title){l.counter=o.counter,l.lastVisit=o.lastVisit
          break}}else for(var i=K.user.folderHM.all,s=0;s<i.bookmarks.lengh;s++){var l=i.bookmarks[s]
        if(o.title===l.title){l.counter=o.counter,l.lastVisit=o.lastVisit
          break}}n.updateBookmark(o)}),e.$on(ROUTE.UPDATE_BOOKMARK_SUCCESS,function(r,e){if(e){var o=e.bookmark,t=K.bookmarkEdit.folder===K.bookmarkEditOriginal.folder
      if(!t){var a=K.user.folderHM[K.bookmarkEditOriginal.folder],s=K.user.folderHM[K.bookmarkEdit.folder]
        if(a&&"all"!=a&&""!=a)for(var l=0;l<a.bookmarks.length;l++){var i=a.bookmarks[l]
          if(i.title===o.title){a.bookmarks.splice(l,1)
            break}}s&&"all"!=s.name&&""!=s&&s.bookmarks.push(o)}o.tags=[],"null"!=o.tag1&&0!=o.tag1.trim("").length&&o.tags.push(o.tag1),"null"!=o.tag2&&0!=o.tag2.trim("").length&&o.tags.push(o.tag2),"null"!=o.tag3&&0!=o.tag3.trim("").length&&o.tags.push(o.tag3),"null"!=o.tag4&&0!=o.tag4.trim("").length&&o.tags.push(o.tag4)
      var u=""
      u+=o.title,u+=" "
      for(var l=0;l<o.tags.length;l++)u+=o.tags[l]+" "
      o.searchstring=u,K.clickOverlay(!0)}else humane.log("That title is invalid or has already been used, try another one",{addCls:"humane-flatty-error"}),K.clickOverlay(!1)
      n.updateBookmark(o)}),e.$on(ROUTE.UPDATE_BOOKMARK_FAIL,function(r,e){})}angular.module("app").controller("DashboardController",r),r.$inject=["$rootScope","$scope","$state","$interval","localStorageService","ServerService","FilterService","StorageService","ServiceWorker"]}()
